"substrate_main_4", "substrate_main_5"), names_to = "x", values_to = "substrate") %>%
select(druh, line, substrate) %>%
na.omit(F)
### fine substrate, delete empty observations, unite columns into species, pivot to long format
data_substrate_fine_23 <-data_23 %>%
filter(!is.na(behavior_1)) %>%
unite(col = "druh", genus, species, sep = "_", remove = TRUE) %>%
pivot_longer(cols = c("substrate_fine_1", "substrate_fine_2", "substrate_fine_3",
"substrate_fine_4", "substrate_fine_5"), names_to = "x",
values_to = "substrate_fine", values_drop_na = T) %>%
select(druh, line, substrate_fine)
data_substrate_fine_24 <-data_24 %>%
filter(!is.na(behavior_1)) %>%
unite(col = "druh", genus, species, sep = "_", remove = TRUE) %>%
pivot_longer(cols = c("substrate_fine_1", "substrate_fine_2", "substrate_fine_3",
"substrate_fine_4", "substrate_fine_5"), names_to = "x",
values_to = "substrate_fine", values_drop_na = T) %>%
select(druh, line, substrate_fine)
### literature data
data_lit_behav <- data_lit %>%
select(species_orig,flycatch,glean,hover_snatch,snatch,pounce, probe)%>%
pivot_longer(cols=c("flycatch","glean","hover_snatch","snatch","pounce", "probe"), names_to="behav",values_to="x")
data_lit_substrate <- data_lit %>%
select(species_orig, air, bark, flower, ground, leaf, other)%>%
pivot_longer(cols=c("air","bark","flower","ground","leaf","other"), names_to="substrate",values_to="x")
### point transect, unite columns, remove non-oscines, count observations
data_bodovka_sp <- data_bodovka %>%
unite(col = "druh", Genus, Species, sep= "_", remove =TRUE) %>%
group_by(Datum, druh)%>%
filter(!(druh=="Columba_oenas"| druh=="Columba_palumbus"| druh=="Buteo_buteo"| druh=="Cuculus_canorus"| druh=="Corvus_corax"| druh=="Dryocopus_martius"| druh=="Dendrocopos_medius"| druh=="Dendrocopos_major"| druh=="Garrulus_glandarius"))%>%
count()
############### Point transect results #######################
## square plot pro presence/absence z bodovky
ggplot(data_bodovka_sp) +
aes(x = Datum, y = druh, fill = n) +
geom_tile(linewidth = 1.2) +
scale_fill_distiller(palette = "Blues", direction = 1) +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5)) +
scale_x_continuous(labels = as.Date(data_bodovka_sp$Datum), breaks = data_bodovka_sp$Datum)
## bubble plot
ggplot(data_bodovka_sp, aes(Datum, druh)) +
geom_point(aes(size = n), colour = "blue", fill = "blue", shape = 21, ) +
labs(x = "", y = "") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5)) +
scale_x_continuous(labels = as.Date(data_bodovka_sp$Datum), breaks = data_bodovka_sp$Datum)
## transformace dat pro porovnani
data_freq_bodovka<- data_bodovka %>%
unite(col = "druh", Genus, Species, sep= "_", remove =TRUE) %>%
group_by(druh)%>%
filter(!(druh=="Columba_oenas"| druh=="Columba_palumbus"| druh=="Buteo_buteo"| druh=="Cuculus_canorus"| druh=="Corvus_corax"| druh=="Dryocopus_martius"| druh=="Dendrocopos_medius"| druh=="Dendrocopos_major"| druh=="Garrulus_glandarius"))%>%
count()%>%
summarise(n)%>%
mutate(prop_bodovka = proportions(n))
data_freq_behav_23 <- data_behav_23%>%
group_by(druh)%>%
count()%>%
summarise(n)%>%
mutate(prop_behav=proportions(n))
data_freq_behav_24 <- data_behav_24%>%
group_by(druh)%>%
count()%>%
summarise(n)%>%
mutate(prop_behav=proportions(n))
## treemap zastoupení druhu bodovka vs pozorovani
treemap_bodovka<-treemap(data_freq_bodovka,
index="druh",
vSize="n",
type="index",
title="freq point transect"
)
treemap_behav_23<-treemap(data_freq_behav_23,
index="druh",
vSize="n",
type="index",
title="freq obs behav"
)
treemap_behav_24<-treemap(data_freq_behav_24,
index="druh",
vSize="n",
type="index",
title="freq obs behav"
)
## frekvenční tabulka
data_freq_compare<-merge(data_freq_bodovka, data_freq_behav, by="druh", all=TRUE)
data_freq_compare<-merge(data_freq_bodovka, data_freq_behav_23, by="druh", all=TRUE)
# display graphs
treemap_bodovka
# display graphs
view(treemap_bodovka)
# display graphs
treemap_bodovka
treemap_behav_23
treemap_behav_24
treemap_behav_23<-treemap(data_freq_behav_23,
index="druh",
vSize="n",
type="index",
title="freq obs behav 23"
)
treemap_behav_24<-treemap(data_freq_behav_24,
index="druh",
vSize="n",
type="index",
title="freq obs behav 24"
)
View(data_24)
View(data_behav_23)
# number of species per year
data_behav_23%>%
group_by(druh)%>%
n_distinct()
# number of species per year
data_behav_23%>%
n_distinct(druh)
# number of species per year
data_behav_23%>%
n_distinct(druh)
# number of species per year
data_behav_23%>%
group_by(druh)
# number of species per year
data_behav_23%>%
group_by(druh)%>%
n_distinct()
# number of species per year
n_distinct(data_behav_23, druh)
# number of species per year
data_behav_23 %>%
summarize(distinct_species = n_distinct(druh))
data_behav_24 %>%
summarize(distinct_species = n_distinct(druh))
treemap_behav_23+treemap_behav_24
treemap_behav_23 + treemap_behav_24
compare<-(treemap_behav_23 + treemap_behav_24)
par(mfrow = c(1, 2))  # Set up a 1x2 grid
plot(treemap_behav_23)
plot(treemap_behav_24)
par(mfrow = c(1, 2))  # Set up a 1x2 grid
treemap_behav_23
treemap_behav_24
par(mfrow = c(1, 1))  # Set up a 1x2 grid
?treemap
# number of species observed
data_behav_23 %>%
summarize(distinct_species = n_distinct(druh))
## proporce druhu na bodovce vs pozorování
ggplot(data_freq_compare) +
aes(x = prop_behav, y = prop_bodovka) +
geom_point(
shape = "asterisk",
size = 1.45,
colour = "#0C350C"
) +
labs(
x = "Proportion of behavioral observations",
y = "Proportion of observations in point transect"
) +
theme_bw() +
xlim(0, 0.2) +
ylim(0, 0.2) + geom_abline()+ geom_text(label=data_freq_compare$druh)
data_freq_compare_behav<-merge(data_freq_behav_24, data_freq_behav_23, by="druh", all=TRUE)
View(data_freq_compare_behav)
data_freq_compare_behav<-merge(data_freq_behav_23, data_freq_behav_24, by="druh", all=TRUE)
View(data_freq_compare_behav)
View(data_freq_compare)
# rozdíly mezi roky 23 a 24
ggplot(data_freq_compare_behav) +
aes(x = prop_behav.x, y = prop_behav.y) +
geom_point(
shape = "asterisk",
size = 1.45,
colour = "#0C350C"
) +
labs(
x = "Proportion of behavioral observations 2023",
y = "Proportion of behavioral observations 2024"
) +
theme_bw() +
xlim(0, 0.2) +
ylim(0, 0.2) + geom_abline()+ geom_text(label=data_freq_compare$druh)
# rozdíly mezi roky 23 a 24
ggplot(data_freq_compare_behav) +
aes(x = prop_behav.x, y = prop_behav.y) +
geom_point(
shape = "asterisk",
size = 1.45,
colour = "#0C350C"
) +
labs(
x = "Proportion of behavioral observations 2023",
y = "Proportion of behavioral observations 2024"
) +
theme_bw() +
xlim(0, 0.2) +
ylim(0, 0.2) + geom_abline()+ geom_text(label=data_freq_compare_behav$druh)
#tabulka s počty foraging actions
tabulka_behav_23 <- as.data.frame.matrix( table(data_behav_23$line, data_behav_23$behav) )
tabulka_behav_24 <- as.data.frame.matrix( table(data_behav_24$line, data_behav_24$behav) )
View(tabulka_behav_23)
View(tabulka_behav_24)
method23<-ggplot(data_behav_23, aes(x = line, fill = behav)) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank(), axis.line = element_line(colour = "black"), legend.title = element_blank(), axis.text.x=element_blank(), legend.background = element_rect(fill='transparent'),
axis.ticks.x=element_blank())+
geom_bar(position="fill")+
scale_y_continuous(labels = scales::percent, expand = c(0, 0), limits = c(0, NA)) +
scale_fill_brewer(palette = "Pastel1")+
labs(x="", y="", title = "Foraging method 2023")
method24<-ggplot(data_behav_24, aes(x = line, fill = behav)) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank(), axis.line = element_line(colour = "black"), legend.title = element_blank(), axis.text.x=element_blank(), legend.background = element_rect(fill='transparent'),
axis.ticks.x=element_blank())+
geom_bar(position="fill")+
scale_y_continuous(labels = scales::percent, expand = c(0, 0), limits = c(0, NA)) +
scale_fill_brewer(palette = "Pastel1")+
labs(x="", y="", title = "Foraging method 2024")
method23+method24
method23<-ggplot(data_behav_23, aes(x = line, fill = behav)) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank(), axis.line = element_line(colour = "black"), legend.title = element_blank(), axis.text.x=element_blank(), legend.background = element_rect(fill='transparent'),
axis.ticks.x=element_blank())+
geom_bar(position="fill")+
scale_y_continuous(labels = scales::percent, expand = c(0, 0), limits = c(0, NA)) +
scale_fill_brewer(palette = "Dark2")+
labs(x="", y="", title = "Foraging method 2023")
method23<-ggplot(data_behav_23, aes(x = line, fill = behav)) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank(), axis.line = element_line(colour = "black"), legend.title = element_blank(), axis.text.x=element_blank(), legend.background = element_rect(fill='transparent'),
axis.ticks.x=element_blank())+
geom_bar(position="fill")+
scale_y_continuous(labels = scales::percent, expand = c(0, 0), limits = c(0, NA)) +
scale_fill_brewer(palette = "Dark2")+
labs(x="", y="", title = "Foraging method 2023")
method24<-ggplot(data_behav_24, aes(x = line, fill = behav)) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank(), axis.line = element_line(colour = "black"), legend.title = element_blank(), axis.text.x=element_blank(), legend.background = element_rect(fill='transparent'),
axis.ticks.x=element_blank())+
geom_bar(position="fill")+
scale_y_continuous(labels = scales::percent, expand = c(0, 0), limits = c(0, NA)) +
scale_fill_brewer(palette = "Dark2")+
labs(x="", y="", title = "Foraging method 2024")
method23+method24
View(data_behav_23)
## Add color palette based on categories in behav
num_categories <- length(unique(data_behav_23$behav))
colors <- brewer.pal(num_categories, "Set1")
library(RColorBrewer)
colors <- brewer.pal(num_categories, "Set1")
category_colors <- setNames(colors, unique(your_dataframe$category_column))
category_colors <- setNames(colors, unique(data_behav_23$behav))
method23<-ggplot(data_behav_23, aes(x = line, fill = behav)) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank(), axis.line = element_line(colour = "black"), legend.title = element_blank(), axis.text.x=element_blank(), legend.background = element_rect(fill='transparent'),
axis.ticks.x=element_blank())+
geom_bar(position="fill")+
scale_y_continuous(labels = scales::percent, expand = c(0, 0), limits = c(0, NA)) +
scale_fill_brewer(palette = "Set1")+
labs(x="", y="", title = "Foraging method 2023")
method24<-ggplot(data_behav_24, aes(x = line, fill = behav)) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank(), axis.line = element_line(colour = "black"), legend.title = element_blank(), axis.text.x=element_blank(), legend.background = element_rect(fill='transparent'),
axis.ticks.x=element_blank())+
geom_bar(position="fill")+
scale_y_continuous(labels = scales::percent, expand = c(0, 0), limits = c(0, NA)) +
scale_fill_brewer(palette = "Set1")
labs(x="", y="", title = "Foraging method 2024")
method23<-ggplot(data_behav_23, aes(x = line, fill = behav)) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank(), axis.line = element_line(colour = "black"), legend.title = element_blank(), axis.text.x=element_blank(), legend.background = element_rect(fill='transparent'),
axis.ticks.x=element_blank())+
geom_bar(position="fill")+
scale_y_continuous(labels = scales::percent, expand = c(0, 0), limits = c(0, NA)) +
scale_fill_brewer(palette = "Set1")+
labs(x="", y="", title = "Foraging method 2023")
method24<-ggplot(data_behav_24, aes(x = line, fill = behav)) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank(), axis.line = element_line(colour = "black"), legend.title = element_blank(), axis.text.x=element_blank(), legend.background = element_rect(fill='transparent'),
axis.ticks.x=element_blank())+
geom_bar(position="fill")+
scale_y_continuous(labels = scales::percent, expand = c(0, 0), limits = c(0, NA)) +
scale_fill_brewer(palette = "Set1")+
labs(x="", y="", title = "Foraging method 2024")
method23+method24
method23<-ggplot(data_behav_23, aes(x = line, fill = behav)) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank(), axis.line = element_line(colour = "black"), legend.title = element_blank(), axis.text.x=element_blank(), legend.background = element_rect(fill='transparent'),
axis.ticks.x=element_blank())+
geom_bar(position="fill")+
scale_y_continuous(labels = scales::percent, expand = c(0, 0), limits = c(0, NA)) +
scale_fill_manual(
values = c(flycatach = "#0cf0e8",
glean = "#06c24b",
hang_glean = "#8B7500",
hover_snatch = "#9606c2",
manipulation = "#0677c2",
pounce = "#2F4F4F",
probe = "#c2b906",
snatch = "#ed8105"))+
labs(x="", y="", title = "Foraging method 2023")
method24<-ggplot(data_behav_24, aes(x = line, fill = behav)) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank(), axis.line = element_line(colour = "black"), legend.title = element_blank(), axis.text.x=element_blank(), legend.background = element_rect(fill='transparent'),
axis.ticks.x=element_blank())+
geom_bar(position="fill")+
scale_y_continuous(labels = scales::percent, expand = c(0, 0), limits = c(0, NA)) +
scale_fill_manual(
values = c(flycatach = "#0cf0e8",
glean = "#06c24b",
hang_glean = "#8B7500",
hover_snatch = "#9606c2",
manipulation = "#0677c2",
pounce = "#2F4F4F",
probe = "#c2b906",
snatch = "#ed8105"))+
labs(x="", y="", title = "Foraging method 2024")
method23+method24
substrate23<-ggplot(data_substrate_23, aes(x = line, fill = substrate)) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank(), axis.line = element_line(colour = "black"),legend.title = element_blank(),axis.text.x=element_blank(),legend.background = element_rect(fill='transparent'),
axis.ticks.x=element_blank())+
geom_bar(position="fill")+
scale_y_continuous(labels = scales::percent, expand = c(0, 0), limits = c(0, NA)) +scale_fill_manual(
values = c(air = "#AEEEEE",
bark = "#F5DEB3",
ground = "#8B7500",
leaf = "#556B2F",
other = "#2F4F4F"))+
labs(x="", y="", title = "Foraging substrate")
substrate24<-ggplot(data_substrate_24, aes(x = line, fill = substrate)) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank(), axis.line = element_line(colour = "black"),legend.title = element_blank(),axis.text.x=element_blank(),legend.background = element_rect(fill='transparent'),
axis.ticks.x=element_blank())+
geom_bar(position="fill")+
scale_y_continuous(labels = scales::percent, expand = c(0, 0), limits = c(0, NA)) +scale_fill_manual(
values = c(air = "#AEEEEE",
bark = "#F5DEB3",
ground = "#8B7500",
leaf = "#556B2F",
other = "#2F4F4F"))+
labs(x="", y="", title = "Foraging substrate")
substrate23 + substrate24
substrate23<-ggplot(data_substrate_23, aes(x = line, fill = substrate)) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank(), axis.line = element_line(colour = "black"),legend.title = element_blank(),axis.text.x=element_blank(),legend.background = element_rect(fill='transparent'),
axis.ticks.x=element_blank())+
geom_bar(position="fill")+
scale_y_continuous(labels = scales::percent, expand = c(0, 0), limits = c(0, NA)) +scale_fill_manual(
values = c(air = "#AEEEEE",
bark = "#F5DEB3",
ground = "#8B7500",
leaf = "#556B2F",
other = "#2F4F4F"))+
labs(x="", y="", title = "Foraging substrate 2023")
substrate24<-ggplot(data_substrate_24, aes(x = line, fill = substrate)) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank(), axis.line = element_line(colour = "black"),legend.title = element_blank(),axis.text.x=element_blank(),legend.background = element_rect(fill='transparent'),
axis.ticks.x=element_blank())+
geom_bar(position="fill")+
scale_y_continuous(labels = scales::percent, expand = c(0, 0), limits = c(0, NA)) +scale_fill_manual(
values = c(air = "#AEEEEE",
bark = "#F5DEB3",
ground = "#8B7500",
leaf = "#556B2F",
other = "#2F4F4F"))+
labs(x="", y="", title = "Foraging substrate 2024")
substrate23 + substrate24
substrate23<-ggplot(data_substrate_23, aes(x = line, fill = substrate)) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank(), axis.line = element_line(colour = "black"),legend.title = element_blank(),axis.text.x=element_blank(),legend.background = element_rect(fill='transparent'),
axis.ticks.x=element_blank())+
geom_bar(position="fill")+
scale_y_continuous(labels = scales::percent, expand = c(0, 0), limits = c(0, NA)) +scale_fill_manual(
values = c(air = "#5AB2A8",
bark = "#CFA154",
ground = "#543005",
leaf = "#003C30",
other = "#003D88"))+
labs(x="", y="", title = "Foraging substrate 2023")
substrate24<-ggplot(data_substrate_24, aes(x = line, fill = substrate)) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank(), axis.line = element_line(colour = "black"),legend.title = element_blank(),axis.text.x=element_blank(),legend.background = element_rect(fill='transparent'),
axis.ticks.x=element_blank())+
geom_bar(position="fill")+
scale_y_continuous(labels = scales::percent, expand = c(0, 0), limits = c(0, NA)) +scale_fill_manual(
values = c(air = "#5AB2A8",
bark = "#CFA154",
ground = "#543005",
leaf = "#003C30",
other = "#003D88"))+
labs(x="", y="", title = "Foraging substrate 2024")
substrate23 + substrate24
behav_substrate_23 <- bind_cols(data_behav_23,data_substrate_23)%>%
select(line...3, druh...1, behav, substrate)%>%
rename(line = line...3, druh=druh...1)
behav_substrate_24 <- bind_cols(data_behav_24,data_substrate_24)%>%
select(line...3, druh...1, behav, substrate)%>%
rename(line = line...3, druh=druh...1)
#vypocet proporci vyuziti substratu a metody
prop_substrate_23<- behav_substrate_23 %>%
group_by(druh) %>%
count(substrate) %>%
mutate(prop_substrate = prop.table(n))
prop_method_23 <- behav_substrate_23 %>%
group_by(druh) %>%
count(behav) %>%
mutate(prop_method = prop.table(n))
prop_substrate_24<- behav_substrate_24 %>%
group_by(druh) %>%
count(substrate) %>%
mutate(prop_substrate = prop.table(n))
prop_method_24 <- behav_substrate_24 %>%
group_by(druh) %>%
count(behav) %>%
mutate(prop_method = prop.table(n))
View(behav_substrate_23)
index_substrate_23 <- behav_substrate_23 %>% #vypocet indexu B a Ba pro substrat
group_by(druh) %>%
count(substrate) %>%
mutate(prop_substrate = prop.table(n)) %>%
mutate(pi2=prop_substrate^2)%>%
select(druh, pi2) %>%
group_by(druh)%>%
summarise(B=1/sum(pi2))%>%
select(druh, B)%>%
group_by(druh,B)%>%
summarise(Ba=1-(B-1)/(6-1))
index_method_23 <- behav_substrate_23 %>% #vypocet indexu B a Ba pro metodu
group_by(druh) %>%
count(behav) %>%
mutate(prop_behav = prop.table(n)) %>%
mutate(pi2=prop_behav^2)%>%
select(druh, pi2) %>%
group_by(druh)%>%
summarise(B=1/sum(pi2))%>%
select(druh, B)%>%
group_by(druh,B)%>%
summarise(Ba=1-(B-1)/(7-1))
index_method_subset_23 <-index_method_23[!(index_method$druh=="Aegithalos_caudatus"|index_method$druh=="Oriolus_oriolus"| index_method$druh=="Phoenicorus_phoenicorus"| index_method$druh=="Sturnus_vulgaris"| index_method$druh=="Sylvia_borin"| index_method$druh=="Certhia_brachydactyla"| index_method$druh=="Turdus_viscivorus"),]
index_substrate_23 <- behav_substrate_23 %>% #vypocet indexu B a Ba pro substrat
group_by(druh) %>%
count(substrate) %>%
mutate(prop_substrate = prop.table(n)) %>%
mutate(pi2=prop_substrate^2)%>%
select(druh, pi2) %>%
group_by(druh)%>%
summarise(B=1/sum(pi2))%>%
select(druh, B)%>%
group_by(druh,B)%>%
summarise(Ba=1-(B-1)/(6-1))
index_method_23 <- behav_substrate_23 %>% #vypocet indexu B a Ba pro metodu
group_by(druh) %>%
count(behav) %>%
mutate(prop_behav = prop.table(n)) %>%
mutate(pi2=prop_behav^2)%>%
select(druh, pi2) %>%
group_by(druh)%>%
summarise(B=1/sum(pi2))%>%
select(druh, B)%>%
group_by(druh,B)%>%
summarise(Ba=1-(B-1)/(7-1))
index_method_subset_23 <-index_method_23[!(index_method_23$druh=="Aegithalos_caudatus"|index_method_23$druh=="Oriolus_oriolus"| index_method_23$druh=="Phoenicorus_phoenicorus"| index_method_23$druh=="Sturnus_vulgaris"| index_method_23$druh=="Sylvia_borin"| index_method_23$druh=="Certhia_brachydactyla"| index_method_23$druh=="Turdus_viscivorus"),]
index_substrate_23_subset_23 <-index_substrate_23_23[!(index_substrate_23$druh=="Aegithalos_caudatus"|index_substrate_23$druh=="Oriolus_oriolus"| index_substrate_23$druh=="Phoenicorus_phoenicorus"| index_substrate_23$druh=="Sturnus_vulgaris"| index_substrate_23$druh=="Sylvia_borin"| index_substrate_23$druh=="Certhia_brachydactyla"| index_substrate_23$druh=="Turdus_viscivorus"),]
index_substrate_23 <-index_substrate_23[!(index_substrate_23$druh=="Aegithalos_caudatus"|index_substrate_23$druh=="Oriolus_oriolus"| index_substrate_23$druh=="Phoenicorus_phoenicorus"| index_substrate_23$druh=="Sturnus_vulgaris"| index_substrate_23$druh=="Sylvia_borin"| index_substrate_23$druh=="Certhia_brachydactyla"| index_substrate_23$druh=="Turdus_viscivorus"),]
index_23<- bind_cols(index_method_23, index_substrate_23) %>%  #do jednoho df
select(druh...1, B...2, Ba...3, B...5, Ba...6) %>%
rename(druh = druh...1, BM=B...2,BaM=Ba...3, BS=B...5, BaS=Ba...6)
index_subset_23<- bind_cols(index_method_subset_23, index_substrate_subset_23) %>%  #do jednoho df
select(druh...1, B...2, Ba...3, B...5, Ba...6) %>%
rename(druh = druh...1, BM=B...2,BaM=Ba...3, BS=B...5, BaS=Ba...6)
index_substrate_subset_23 <-index_substrate_23[!(index_substrate_23$druh=="Aegithalos_caudatus"|index_substrate_23$druh=="Oriolus_oriolus"| index_substrate_23$druh=="Phoenicorus_phoenicorus"| index_substrate_23$druh=="Sturnus_vulgaris"| index_substrate_23$druh=="Sylvia_borin"| index_substrate_23$druh=="Certhia_brachydactyla"| index_substrate_23$druh=="Turdus_viscivorus"),]
index_23<- bind_cols(index_method_23, index_substrate_23) %>%  #do jednoho df
select(druh...1, B...2, Ba...3, B...5, Ba...6) %>%
rename(druh = druh...1, BM=B...2,BaM=Ba...3, BS=B...5, BaS=Ba...6)
index_subset_23<- bind_cols(index_method_subset_23, index_substrate_subset_23) %>%  #do jednoho df
select(druh...1, B...2, Ba...3, B...5, Ba...6) %>%
rename(druh = druh...1, BM=B...2,BaM=Ba...3, BS=B...5, BaS=Ba...6)
index_23<- bind_cols(index_method_23, index_substrate_23) %>%  #do jednoho df
select(druh...1, B...2, Ba...3, B...5, Ba...6) %>%
rename(druh = druh...1, BM=B...2,BaM=Ba...3, BS=B...5, BaS=Ba...6)
index_subset_23<- bind_cols(index_method_subset_23, index_substrate_subset_23) %>%  #do jednoho df
select(druh...1, B...2, Ba...3, B...5, Ba...6) %>%
rename(druh = druh...1, BM=B...2,BaM=Ba...3, BS=B...5, BaS=Ba...6)
par(mar = c(5, 5, 5, 5))
plot(BaS ~ BaM, xlim = c(0.4, 1), ylim = c(0.4, 1), ylab="Substrate specialization",xlab="Method specialization", data=index_subset_23, cex.lab=2, pch=19)
abline(lm(BaS ~ BaM, index_subset), lw=1.3)
plot(BaS ~ BaM, xlim = c(0.4, 1), ylim = c(0.4, 1), ylab="Substrate specialization",xlab="Method specialization", data=index_subset_23, cex.lab=2, pch=19)
abline(lm(BaS ~ BaM, index_subset_23), lw=1.3)
abline(c(0,1), lty=2, col="red")
summary(lm(BaS ~ BaM, index_subset_23))
index_substrate_24 <- behav_substrate_24 %>% #vypocet indexu B a Ba pro substrat
group_by(druh) %>%
count(substrate) %>%
mutate(prop_substrate = prop.table(n)) %>%
mutate(pi2=prop_substrate^2)%>%
select(druh, pi2) %>%
group_by(druh)%>%
summarise(B=1/sum(pi2))%>%
select(druh, B)%>%
group_by(druh,B)%>%
summarise(Ba=1-(B-1)/(6-1))
index_method_24 <- behav_substrate_24 %>% #vypocet indexu B a Ba pro metodu
group_by(druh) %>%
count(behav) %>%
mutate(prop_behav = prop.table(n)) %>%
mutate(pi2=prop_behav^2)%>%
select(druh, pi2) %>%
group_by(druh)%>%
summarise(B=1/sum(pi2))%>%
select(druh, B)%>%
group_by(druh,B)%>%
summarise(Ba=1-(B-1)/(7-1))
index_method_subset_24 <-index_method_24[!(index_method_24$druh=="Aegithalos_caudatus"|index_method_24$druh=="Oriolus_oriolus"| index_method_24$druh=="Phoenicorus_phoenicorus"| index_method_24$druh=="Sturnus_vulgaris"| index_method_24$druh=="Sylvia_borin"| index_method_24$druh=="Certhia_brachydactyla"| index_method_24$druh=="Turdus_viscivorus"),]
index_substrate_subset_24 <-index_substrate_24[!(index_substrate_24$druh=="Aegithalos_caudatus"|index_substrate_24$druh=="Oriolus_oriolus"| index_substrate_24$druh=="Phoenicorus_phoenicorus"| index_substrate_24$druh=="Sturnus_vulgaris"| index_substrate_24$druh=="Sylvia_borin"| index_substrate_24$druh=="Certhia_brachydactyla"| index_substrate_24$druh=="Turdus_viscivorus"),]
index_24<- bind_cols(index_method_24, index_substrate_24) %>%  #do jednoho df
select(druh...1, B...2, Ba...3, B...5, Ba...6) %>%
rename(druh = druh...1, BM=B...2,BaM=Ba...3, BS=B...5, BaS=Ba...6)
index_subset_24<- bind_cols(index_method_subset_24, index_substrate_subset_24) %>%  #do jednoho df
select(druh...1, B...2, Ba...3, B...5, Ba...6) %>%
rename(druh = druh...1, BM=B...2,BaM=Ba...3, BS=B...5, BaS=Ba...6)
### Scatterplot specializace metoda/substrat
par(mar = c(5, 5, 5, 5))
plot(BaS ~ BaM, xlim = c(0.4, 1), ylim = c(0.4, 1), data=index_24, xlab="Specializace na substrat",ylab="Specializace na metodu", pch=19)
abline(lm(BaS ~ BaM, index), lw=1.3)
abline(c(0,1), lty=2, col="red")
par(mar = c(5, 5, 5, 5))
plot(BaS ~ BaM, xlim = c(0.4, 1), ylim = c(0.4, 1), ylab="Substrate specialization",xlab="Method specialization", data=index_subset_24, cex.lab=2, pch=19)
abline(lm(BaS ~ BaM, index_subset_24), lw=1.3)
abline(c(0,1), lty=2, col="red")
summary(lm(BaS ~ BaM, index_subset_24))
